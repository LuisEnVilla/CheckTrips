mixin sumas(viaje,viaticos,hospedaje)
	-var sum = 0
	-var items = [viaje,viaticos,hospedaje]
	each i in items
		if !isNaN(i)
			- sum += i
	| #{sum}
extends layout

block content
	include ./header
	.intro-header
		.container
			.row
				.col-lg-12
					.intro-message
						h1 Checkifai
						h4: kbd Realiza una búsqueda o explora los viajes de los funcionarios
						.row
							.col-md-6.col-md-offset-3
								form
									.input-group
										input.form-control(type="text" placeholder="Búsqueda")
										span.input-group-btn
											button.form-control.btn(type="submit" value="Buscar")
												span.glyphicon.glyphicon-search
						a.btn.btn-lg.raised-btn(href="#top") Explorar
		.container
			.row#top
				h2.top-title Viajes más recientes
			.row
				each viaje, i in fecha
					.col-md-4(id = viaje.Consecutivo)
						.card.small
							.card-img
								if viaje.Tipo == "Nacional"
									h4 #{viaje.Origen.Estado} <i class="glyphicon glyphicon-chevron-right"></i>  #{viaje.Destino.Estado}
								else
									h4 #{viaje.Origen.Pais} <i class="glyphicon glyphicon-send"></i>  #{viaje.Destino.Pais}
							.card-content
								dl.dl-horizontal
									dt: span.glyphicon.glyphicon-bookmark 
									dd #{viaje.Tema}
									dt: span.glyphicon.glyphicon-user
									dd #{viaje.Funcionario_id.Nombre.Nombres} #{viaje.Funcionario_id.Nombre.ApellidoP }
									dt: span.glyphicon.glyphicon-briefcase
									dd #{viaje.Funcionario_id.Trabajo.UnidadAdministrativa}
									dt: span.glyphicon.glyphicon-file
									dd #{viaje.Consecutivo}
									dt: span.glyphicon.glyphicon-calendar
									dd #{viaje.FechaInicio}
							.card-control
								a.compare-icon
									span.glyphicon.glyphicon-stats.pull-left
								a.flat-btn.pull-right(href ="/profile/" + viaje._id) Ver más
			.row
				h2.top-title Viajes más costosos en traslado
			.row
				each viaje, i in viajes
					.col-md-4(id = viaje.Consecutivo)
						.card.small
							.card-img
								if viaje.Tipo == "Nacional"
									h4 #{viaje.Origen.Estado} <i class="glyphicon glyphicon-chevron-right"></i>  #{viaje.Destino.Estado}
								else
									h4 #{viaje.Origen.Pais} <i class="glyphicon glyphicon-send"></i>  #{viaje.Destino.Pais}
							.card-content
								dl.dl-horizontal
									dt: span.glyphicon.glyphicon-bookmark 
									dd #{viaje.Tema}
									dt: span.glyphicon.glyphicon-user
									dd #{viaje.Funcionario_id.Nombre.Nombres} #{viaje.Funcionario_id.Nombre.ApellidoP }
									dt: span.glyphicon.glyphicon-briefcase
									dd #{viaje.Funcionario_id.Trabajo.UnidadAdministrativa}
									dt: span.glyphicon.glyphicon-file
									dd #{viaje.Consecutivo}
									dt: span.glyphicon.glyphicon-usd
									dd
										+sumas(viaje.GastoPasaje,viaje.GastosViaticos,viaje.CostoHospedaje)
							.card-control
								a.compare-icon
									span.glyphicon.glyphicon-stats.pull-left
								a.flat-btn.pull-right(href ="/profile/" + viaje._id) Ver más
			.row
				h2.top-title Viajes más costosos en viaticos
			.row
				each viaje, i in viajes2
					.col-md-4(id = viaje.Consecutivo)
						.card.small
							.card-img
								if viaje.Tipo == "Nacional"
									h4 #{viaje.Origen.Estado} <i class="glyphicon glyphicon-chevron-right"></i>  #{viaje.Destino.Estado}
								else
									h4 #{viaje.Origen.Pais} <i class="glyphicon glyphicon-send"></i>  #{viaje.Destino.Pais}
							.card-content
								dl.dl-horizontal
									dt: span.glyphicon.glyphicon-bookmark 
									dd #{viaje.Tema}
									dt: span.glyphicon.glyphicon-user
									dd #{viaje.Funcionario_id.Nombre.Nombres} #{viaje.Funcionario_id.Nombre.ApellidoP }
									dt: span.glyphicon.glyphicon-briefcase
									dd #{viaje.Funcionario_id.Trabajo.UnidadAdministrativa}
									dt: span.glyphicon.glyphicon-file
									dd #{viaje.Consecutivo}
									dt: span.glyphicon.glyphicon-usd
									dd
										+sumas(viaje.GastoPasaje,viaje.GastosViaticos,viaje.CostoHospedaje)
							.card-control
								a.compare-icon
									span.glyphicon.glyphicon-stats.pull-left
								a.flat-btn.pull-right(href ="/profile/" + viaje._id) Ver más
			.row
				h2.top-title Unidades que mas han viajado
			.row
				each viaje, i in unidades
					.col-md-4
						.card.micro
							.card-img
								h5 #{viaje.Nombre}
							.card-content
								dl.dl-horizontal
									dt: span.glyphicon.glyphicon-send
									dd  #{viaje.CounViajes } Viajes
									dt: span.glyphicon.glyphicon-user
									dd  #{viaje.CountFuncionarios} Funcionarios
							.card-control
								a.compare-icon
									span.glyphicon.glyphicon-stats.pull-left
								a.flat-btn.pull-right Ver más
		include ./footer